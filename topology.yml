---
plugin: [multilab]
provider: clab

defaults:
  multilab.id: 1
  devices:
    iol:
      clab:
        image: asifsyd/cisco_iol:17.12.01
    eos:
      clab:
        image: asifsyd/ceos:4.32.0F
    ioll2:
      clab:
        image: asifsyd/cisco_iol:l2-17.12.01
    linux:
      clab:
        image: alpine:latest

module: [gateway]

vlans:
  vlan_10:
    id: 10
    prefix: 172.16.0.0/24
    gateway:
      ipv4: 172.16.0.254
  vlan_20:
    id: 20
    prefix: 172.16.1.0/24
    gateway:
      ipv4: 172.16.1.254

nodes:
  R1:
  D1:
    config: [templates/D1.j2]
  D2:
    config: [templates/D2.j2]
  S1:
    config: [templates/S1.j2]
  S2:
    config: [templates/S2.j2]
  H1:
    routing:
      static:
        - ipv4: 172.16.0.0/24
          nexthop:
            ipv4: 172.16.0.254
  H2:
    routing:
      static:
        - ipv4: 172.16.1.0/24
          nexthop:
            ipv4: 172.16.1.254

groups:
  core:
    members: [R1]
    device: iol
    module: [ospf]
    ospf:
      area: 0
  dist:
    members: [D1, D2]
    device: eos
    module: [vlan, ospf]
    ospf:
      area: 0
    vlan:
      mode: irb
  access:
    members: [S1, S2]
    device: ioll2
    module: [vlan]
    vlan:
      mode: bridge
  host:
    members: [H1, H2]
    device: linux
    module: [routing]
links:
  - R1-D1
  - R1-D2
  - H1:
    S1:
      vlan.access: vlan_10
  - H2:
    S2:
      vlan.access: vlan_20
  - group: access_trunk
    vlan.trunk: [vlan_10, vlan_20]
    members: [D1-S1, D2-S2, D1-D2]
