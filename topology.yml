---
plugin: [multilab]
provider: clab

defaults:
  multilab.id: 1 # Unique ID to avoid conflict with previous lab (ID 1)
  devices:
    iol:
      clab:
        image: asifsyd/cisco_iol:17.12.01
    eos:
      clab:
        image: asifsyd/ceos:4.32.0F
    ioll2:
      clab:
        image: asifsyd/cisco_iol:l2-17.12.01
    linux:
      clab:
        image: alpine:latest
  devices.linux.group_vars.netlab_lldp_enable: False # Match previous lab

gateway:
  protocol: vrrp
  vrrp:
    group: 1 # Explicit VRRP group ID for consistency

vlans:
  vlan_10:
    id: 10 # Explicit VLAN ID
    gateway: true
  vlan_20:
    id: 20
    gateway: true

nodes:
  R1:
  D1:
    gateway:
      vrrp:
        priority: 200
  D2:
    gateway:
      vrrp:
        priority: 100
  S1:
  S2:
  H1:
  H2:

groups:
  core:
    members: [R1]
    device: iol
    module: [ospf]
    ospf:
      area: 0
  dist:
    members: [D1, D2]
    device: eos
    module: [vlan, ospf, gateway]
    ospf:
      area: 0
    vlan:
      mode: irb
  access:
    members: [S1, S2]
    device: ioll2
    module: [vlan]
    vlan:
      mode: bridge
  host:
    members: [H1, H2]
    device: linux
    role: host

links:
  - R1-D1
  - R1-D2
  - H1:
    S1:
      vlan.access: vlan_10
  - H2:
    S2:
      vlan.access: vlan_20
  - D1:
    S1:
    vlan.trunk: [vlan_10, vlan_20]
  - D2:
    S2:
    vlan.trunk: [vlan_10, vlan_20]
